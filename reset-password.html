<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reset Password</title>

<style>
   
body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(to bottom, #FF9933, #ffffff, #138808);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.card {
    background: #f9f9f9;
    width: 400px;
    padding: 50px 40px;
    border-radius: 20px;
    text-align: center;
    box-shadow: 0 20px 50px rgba(0,0,0,0.25);
    border-top: 10px solid #FF9933;
    border-bottom: 10px solid #138808;
    position: relative;
}

.chakra {
    font-size: 34px;
    margin-bottom: 15px;
    color: #000080;
}

h2 {
    margin-bottom: 30px;
    color: #0a2a66;
    font-weight: 600;
}

.input-group {
    position: relative;
    margin-bottom: 30px;
}

input {
    width: 100%;
    padding: 14px 45px 14px 15px;
    border-radius: 10px;
    border: 2px solid #0a2a66;
    font-size: 15px;
    outline: none;
    box-sizing: border-box;
}

input:focus {
    border-color: #138808;
}

.toggle-btn {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    font-size: 16px;
}

button {
    width: 100%;
    padding: 14px;
    border-radius: 10px;
    border: none;
    background: #138808;
    color: white;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
}

button:hover {
    background: #0f6f06;
    transform: translateY(-2px);
}

.tagline {
    margin-top: 20px;
    font-size: 13px;
    color: #555;
    font-style: italic;
}
</style>


</head>

<body>

<div class="card">
    <div class="chakra">üõû</div>
    <h2>Reset Your Password</h2>

    <div class="input-group">
        <input type="password" id="newPassword" placeholder="Enter new password">
        <span class="toggle-btn" onclick="togglePassword()">üëÅ</span>
    </div>

    <button onclick="resetPassword()" id="resetBtn">
        Reset Password
    </button>

    <p id="message"></p>
</div>



<script>
const API = "https://rajneeti-backend.onrender.com";
const params = new URLSearchParams(window.location.search);
const token = params.get("token");

function togglePassword() {
    const passwordInput = document.getElementById("newPassword");
    passwordInput.type = passwordInput.type === "password" ? "text" : "password";
}

async function resetPassword() {
    const password = document.getElementById("newPassword").value;
    const message = document.getElementById("message");
    const btn = document.getElementById("resetBtn");

    if (!password) {
        message.innerHTML = "Please enter a password";
        message.className = "error";
        return;
    }

    btn.innerHTML = "Resetting...";
    btn.disabled = true;

    try {
        const response = await fetch(`${API}/reset-password`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                token: token,
                new_password: password
            })
        });

        const data = await response.json();

        if (response.ok) {
            message.innerHTML = "Password reset successful!";
            message.className = "success";
            setTimeout(() => {
                window.location.href = "index.html";
            }, 2000);
        } else {
            message.innerHTML = data.detail;
            message.className = "error";
        }
    } catch (error) {
        message.innerHTML = "Something went wrong.";
        message.className = "error";
    }

    btn.innerHTML = "Reset Password";
    btn.disabled = false;
}
</script>

</body>
</html>
